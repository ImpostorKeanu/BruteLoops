
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Database Management - BruteLoops Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#database-management" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="BruteLoops Documentation" class="md-header__button md-logo" aria-label="BruteLoops Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BruteLoops Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Database Management
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BruteLoops Documentation" class="md-nav__button md-logo" aria-label="BruteLoops Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    BruteLoops Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        BruteLoops Docs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/" class="md-nav__link">
        Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Reference
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../package-documentation/" class="md-nav__link">
        Package Documentation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../complete_examples/" class="md-nav__link">
        Complete Attack Examples
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#methods-for-creating-resource-records" class="md-nav__link">
    Methods for Creating Resource Records
  </a>
  
    <nav class="md-nav" aria-label="Methods for Creating Resource Records">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods-for-deleting-resource-records" class="md-nav__link">
    Methods for Deleting Resource Records
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-management-methods" class="md-nav__link">
    Resource Management Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usernames-from-a-file-passwords-from-list" class="md-nav__link">
    Usernames from a File, Passwords from List
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteloops.db_manager" class="md-nav__link">
    bruteloops.db_manager
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin" class="md-nav__link">
    DBMixin
  </a>
  
    <nav class="md-nav" aria-label="DBMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.associate_spray_values" class="md-nav__link">
    associate_spray_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.delete_credential_records" class="md-nav__link">
    delete_credential_records()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.delete_lines" class="md-nav__link">
    delete_lines()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.delete_password_records" class="md-nav__link">
    delete_password_records()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.delete_username_records" class="md-nav__link">
    delete_username_records()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.disable_username_records" class="md-nav__link">
    disable_username_records()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.do_upsert" class="md-nav__link">
    do_upsert()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.enable_username_records" class="md-nav__link">
    enable_username_records()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.get_or_create" class="md-nav__link">
    get_or_create()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.get_strict_credentials" class="md-nav__link">
    get_strict_credentials()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.get_valid_credentials" class="md-nav__link">
    get_valid_credentials()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.insert_credential_records" class="md-nav__link">
    insert_credential_records()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.insert_password_records" class="md-nav__link">
    insert_password_records()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.insert_username_records" class="md-nav__link">
    insert_username_records()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.manage_credentials" class="md-nav__link">
    manage_credentials()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.manage_priorities" class="md-nav__link">
    manage_priorities()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.manage_values" class="md-nav__link">
    manage_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.DBMixin.sync_lookup_tables" class="md-nav__link">
    sync_lookup_tables()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteloops.db_manager.Manager" class="md-nav__link">
    Manager
  </a>
  
    <nav class="md-nav" aria-label="Manager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.Manager.main_db_sess" class="md-nav__link">
    main_db_sess
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.Manager.session_maker" class="md-nav__link">
    session_maker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.Manager.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteloops.db_manager.Session" class="md-nav__link">
    Session
  </a>
  
    <nav class="md-nav" aria-label="Session">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.Session.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteloops.db_manager.Session.new" class="md-nav__link">
    new()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteloops.db_manager.check_container" class="md-nav__link">
    check_container()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteloops.db_manager.chunk_container" class="md-nav__link">
    chunk_container()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteloops.db_manager.csv_split" class="md-nav__link">
    csv_split()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteloops.db_manager.flatten_dict_values" class="md-nav__link">
    flatten_dict_values()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteloops.db_manager.is_iterable" class="md-nav__link">
    is_iterable()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteloops.db_manager.scan_dictreader" class="md-nav__link">
    scan_dictreader()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteloops.db_manager.split_credential_container" class="md-nav__link">
    split_credential_container()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteloops.db_manager.strip_newline" class="md-nav__link">
    strip_newline()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="database-management">Database Management</h1>
<p>BruteLoops provides classes to simplify management of databases
and database records.</p>
<ul>
<li>Instantiate a <a href="#bruteloops.db_manager.Manager"><code>Manager</code></a> object to
  quickly create a SQLite database and begin managing records.</li>
<li>See <a href="#bruteloops.db_manager.DBMixin"><code>DBMixin</code></a> for relevant management
  methods, such as:<ul>
<li><a href="#bruteloops.db_manager.DBMixin.manage_values"><code>DBMixin.manage_values</code></a>
  to manage individual <code>username</code> and <code>password</code> records.</li>
<li><a href="#bruteloops.db_manager.DBMixin.manage_credentials"><code>DBMixin.manage_credentials</code></a>
  to manage credentials.</li>
</ul>
</li>
</ul>
<h2 id="methods-for-creating-resource-records">Methods for Creating Resource Records</h2>
<p>There are individual methods for creating resource records:</p>
<ul>
<li><a href="#bruteloops.db_manager.DBMixin.insert_username_records"><code>insert_username_records</code></a></li>
<li><a href="#bruteloops.db_manager.DBMixin.insert_password_records"><code>insert_password_records</code></a></li>
<li><a href="#bruteloops.db_manager.DBMixin.insert_credential_records"><code>insert_credential_records</code></a> (<code>as_credentials</code> set to <code>False</code>)</li>
</ul>
<p><code>insert_username_records</code> and <code>insert_password_records</code> have an
obvious purpose: they insert records into their respective
database table.</p>
<p>However, <code>insert_credential_records</code> deserves greater explanation.
This method:</p>
<ul>
<li>Accepts a container of delimited strings, e.g. <code>username:password</code></li>
<li>The string is broken out into individual username and password
  record values and then inserted into the database.</li>
<li>When the <code>as_credentials</code> argument is <code>False</code>, the values are
  imported and treated as spray values, i.e. the passwords will
  be tried for all usernames.</li>
<li>When the <code>as_credentials</code> argument is set to <code>True</code>, they will be
  be treated as <code>StrictCredentials</code>, i.e. the password will be
  guessed for usernames which it has been expressly configured for.<ul>
<li>However, all other passwords will be guessed for the username
  after all <code>StrictCredentials</code> have been exhausted.</li>
</ul>
</li>
</ul>
<h3 id="methods-for-deleting-resource-records">Methods for Deleting Resource Records</h3>
<p>The following methods follow the same semantics described above,
except they delete records from the database.</p>
<ul>
<li><a href="#bruteloops.db_manager.DBMixin.delete_username_records"><code>delete_username_records</code></a></li>
<li><a href="#bruteloops.db_manager.DBMixin.delete_password_records"><code>delete_password_records</code></a></li>
<li><a href="#bruteloops.db_manager.DBMixin.delete_credential_records"><code>delete_credential_records</code></a></li>
</ul>
<h3 id="resource-management-methods">Resource Management Methods</h3>
<p>These methods compliment previously described methods by providing
logic to handle containers of various types:</p>
<p><em>Methods:</em></p>
<ul>
<li><a href="#bruteloops.db_manager.DBMixin.manage_values"><code>manage_values</code></a> - Inserts/deletes usernames and passwords.</li>
<li><a href="#bruteloops.db_manager.DBMixin.manage_credentials"><code>manage_credentials</code></a> - Inserts/deletes credentials.</li>
</ul>
<p><em>Container Types:</em></p>
<p>Management methods always accept a list of strings and a flag that
determines how values in the list should be treated, e.g. the
<code>is_file</code> flag indicates that each value points to a file of
values.</p>
<ul>
<li>When no <code>is_file</code> or <code>is_csv_file</code> flag is set, the values
  are treated as the records to import.</li>
<li>When <code>is_file</code> is <code>True</code>: values are file paths to newline
  delimited files for opening.</li>
<li>When <code>is_csv_file</code> is <code>True</code>: values are file paths to CSV
  files for parsing. (<code>manage_credential_values</code> only)</li>
</ul>
<h2 id="examples">Examples</h2>
<h3 id="usernames-from-a-file-passwords-from-list">Usernames from a File, Passwords from List</h3>
<p>This example imports a list of usernames and passwords into
a newly created database.</p>
<p><em>The Username File (<code>/tmp/usernames.txt</code>)</em></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>user1
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>user2
</code></pre></div>
<p><em>Calling the Methods</em></p>
<p>This would populate the database with:</p>
<ul>
<li>2 usernames from file</li>
<li>3 spray passwords directly</li>
<li>Produce a total of 6 credentials to guess</li>
<li><code>usernames*passwords=total_credentials</code></li>
<li><code>2*3=6</code></li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span> <span class="nn">bruteloops</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">dbm</span> <span class="o">=</span> <span class="n">bruteloops</span><span class="o">.</span><span class="n">db_manager</span><span class="o">.</span><span class="n">Manager</span><span class="p">(</span><span class="s1">&#39;/tmp/test.db&#39;</span><span class="p">)</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># Import the usernames from disk first</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">dbm</span><span class="o">.</span><span class="n">manage_values</span><span class="p">(</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="n">model</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">,</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    <span class="n">container</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;/tmp/usernames.txt&#39;</span><span class="p">],</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    <span class="n">is_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c1"># Import passwords and associate them with all usernames</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="n">dbm</span><span class="o">.</span><span class="n">manage_values</span><span class="p">(</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="n">model</span><span class="o">=</span><span class="s1">&#39;password&#39;</span><span class="p">,</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    <span class="n">container</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;p2&#39;</span><span class="p">,</span> <span class="s1">&#39;p3&#39;</span><span class="p">],</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<hr />


<div class="doc doc-object doc-module">


<a id="bruteloops.db_manager"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="bruteloops.db_manager.DBMixin" class="doc doc-heading">
        <code>DBMixin</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>This class provides methods for managing SQLite databases
supporting brute force attacks.</p>


        <details class="quote">
          <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="k">class</span> <span class="nc">DBMixin</span><span class="p">:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="sd">&#39;&#39;&#39;This class provides methods for managing SQLite databases</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">    supporting brute force attacks.</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="k">def</span> <span class="nf">do_upsert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="n">index_elements</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="n">do_update_where</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_data</span><span class="p">:</span><span class="nb">dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="n">logger</span><span class="p">:</span><span class="n">Logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="sd">&#39;&#39;&#39;Insert values into a model (database table) via upsert.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">          model: SQLAlchemy ORM model.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">          values: Values to insert into the database table.</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">          do_update_where: Condition that determines if records</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            should be updated during the upsert, e.g.</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            sql.Password.sprayable == False. When supplied, only</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            records matching the condition will be altered.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">          update_data: Dictionary of field to value mappings used to</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">            update fields.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">          logger: Logger instance used to send log events.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="c1"># https://docs.sqlalchemy.org/en/14/dialects/sqlite.html#insert-on-conflict-upsert</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="k">if</span> <span class="n">do_update_where</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">update_data</span><span class="p">:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="c1"># TODO: Perform checks on do_update where</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="c1"># must be a query, I think.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">update_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>                    <span class="sa">f</span><span class="s1">&#39;update_data must be a dictionary of data&#39;</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">on_conflict_do_update</span><span class="p">(</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>                <span class="n">index_elements</span><span class="o">=</span><span class="n">index_elements</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>                <span class="n">where</span><span class="o">=</span><span class="n">do_update_where</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                <span class="n">set_</span><span class="o">=</span><span class="n">update_data</span><span class="p">)</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">on_conflict_do_nothing</span><span class="p">(</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>                <span class="n">index_elements</span><span class="o">=</span><span class="n">index_elements</span><span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">begin_nested</span><span class="p">():</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Failed to upsert values: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="k">def</span> <span class="nf">delete_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="sd">&#39;&#39;&#39;Delete lines from `container`.</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="k">def</span> <span class="nf">_delete_values</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                <span class="n">delete</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                    <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">chunk</span><span class="p">)))</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="n">chunk_container</span><span class="p">(</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>            <span class="n">callback</span> <span class="o">=</span> <span class="n">_delete_values</span><span class="p">)</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="k">def</span> <span class="nf">manage_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">,</span><span class="s1">&#39;password&#39;</span><span class="p">],</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="n">container</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="n">is_file</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">insert</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="n">associate_spray_values</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>            <span class="n">logger</span><span class="p">:</span><span class="n">Logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="sd">&#39;&#39;&#39;Manage username and password database records in a database.</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        It serves the same purpose as other `insert_` methods while</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        also handling containers of various file types.</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">          model: Name of the model to target, i.e. username or</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">            password.</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">          container: A list of string values.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">          insert: Determines if values should be inserted (`True`) or</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">            deleted (`False`). The `is_flag` argument indicates if the</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">            values within `container` should be treated as file paths.</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">          is_file: Indicates if container values point to string file</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">            paths. When `True`, each file will be accessed and</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">            imported to the database.</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">          associate_spray_values: Determines if association records</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">            should be created for the newly imported values. This</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">            can often be delayed until the final passwords have been</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">            imported.</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">          logger: Used to log events.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">          - This method is used to import spray values into the</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">            database.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">          - Use `DBMixin.manage_credentials` to import credential</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">            values in the database.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">            - Yes, `manage_credentials` can be used to treat credential</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">              records as spray values, too.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="c1"># ================================</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="c1"># DERIVE METHOD AND PREPARE KWARGS</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="c1"># ================================</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="c1"># Derive the target method to call based on action</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="n">method</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;insert&#39;</span> <span class="k">if</span> <span class="n">insert</span> <span class="k">else</span> <span class="s1">&#39;delete&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> \
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                <span class="p">(</span><span class="s1">&#39;username&#39;</span> <span class="k">if</span> <span class="n">model</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">,</span><span class="s1">&#39;username&#39;</span><span class="p">,)</span> <span class="k">else</span> <span class="s1">&#39;password&#39;</span><span class="p">)</span> <span class="o">+</span> \
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                <span class="s1">&#39;_records&#39;</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="c1"># Prepare kwargs</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                <span class="n">associate_spray_values</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                    <span class="n">method</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                    <span class="ow">and</span> <span class="n">associate_spray_values</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                <span class="p">)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="c1"># ===================================</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="c1"># CALL THE METHOD BASED ON INPUT TYPE</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="c1"># ===================================</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="k">if</span> <span class="n">is_file</span><span class="p">:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                    <span class="n">method</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>            <span class="n">method</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="c1"># This method commits :)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sync_lookup_tables</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="c1"># ===========================</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="c1"># USERNAME MANAGEMENT METHODS</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="c1"># ===========================</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="k">def</span> <span class="nf">insert_username_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>            <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="sd">&#39;&#39;&#39;Insert each username value in the container into the target</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">        database. Duplicates will not be inserted.</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="k">def</span> <span class="nf">_upsert_values</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>                <span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">,</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>                <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">])</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="k">if</span> <span class="n">associate_spray_values</span><span class="p">:</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">associate_spray_values</span><span class="p">(</span><span class="n">username_values</span><span class="o">=</span><span class="n">chunk</span><span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="n">chunk_container</span><span class="p">(</span><span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="n">callback</span> <span class="o">=</span> <span class="n">_upsert_values</span><span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="k">def</span> <span class="nf">delete_username_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">):</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="sd">&#39;&#39;&#39;Delete each username value in the container from the target</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">        database. Values that do not exist in the database are ignored.</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delete_lines</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="k">def</span> <span class="nf">disable_username_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">):</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="sd">&#39;&#39;&#39;Set the actionable attribute on each record in the container</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        to False, removing them from further guesses.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="n">update</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>                <span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>                    <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">container</span><span class="p">),</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>                    <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">actionable</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>                <span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">actionable</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="k">def</span> <span class="nf">enable_username_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">):</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="sd">&#39;&#39;&#39;Set the actionable attribute on each record in the container</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">        to True, ensuring they will be targeted for further guesses.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>            <span class="n">update</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>                <span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                    <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">container</span><span class="p">),</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                    <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">actionable</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                <span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">actionable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="c1"># ===========================</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="c1"># PASSWORD MANAGEMENT METHODS</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="c1"># ===========================</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="k">def</span> <span class="nf">insert_password_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>        <span class="sd">&#39;&#39;&#39;Insert individual password records. Additional processing must</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        occur on individual passwords in order to make the associations</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">        with username values.</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        Warning: This method assumes that the container has spray records,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">        resulting in each password being associated with each username in</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">        the form of a potential credential.</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>        <span class="k">def</span> <span class="nf">_upsert_values</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>            <span class="sd">&#39;&#39;&#39;Upsert password values.</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            Function ensures that password values inserted are treated</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">            as spray values. Should a known password be supplied in</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">            chunk and that password&#39;s &quot;sprayable&quot; attribute be set to</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            False, it will be updated to True.</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">            &#39;&#39;&#39;</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                <span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">,</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">],</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                <span class="n">do_update_where</span> <span class="o">=</span> <span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">sprayable</span> <span class="o">==</span> <span class="kc">False</span><span class="p">),</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>                <span class="n">update_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sprayable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>            <span class="k">if</span> <span class="n">associate_spray_values</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">associate_spray_values</span><span class="p">(</span><span class="n">password_values</span><span class="o">=</span><span class="n">chunk</span><span class="p">)</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>        <span class="n">chunk_container</span><span class="p">(</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>            <span class="n">callback</span> <span class="o">=</span> <span class="n">_upsert_values</span><span class="p">)</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="c1"># This method commits :)</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sync_lookup_tables</span><span class="p">()</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="k">def</span> <span class="nf">associate_spray_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username_values</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>            <span class="n">password_values</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span><span class="n">Logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="sd">&#39;&#39;&#39;Create records in the credentials association table for</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">        spray values.</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">        When called _without_ `username` and/or `password` values,</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">        association records will be created for all sprayable</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">        passwords and accounts that have not yet been recovered.</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">        When called with `username` and/or `password` arguments,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">        only create association records where their values are</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">        matched in their respective tables. This makes insertion</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">        significantly more efficient.</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">          username_values: A list of username values to associate.</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">          password_values: A list of string password values to</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">            associate.</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">          logger: Logger instance.</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="n">AND_TEMP</span> <span class="o">=</span> <span class="s1">&#39; AND </span><span class="si">{table}</span><span class="s1">.value IN (&quot;</span><span class="si">{values}</span><span class="s1">&quot;)&#39;</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Associating spray values.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="c1"># TODO: Update this to use the ORM. It&#39;s complicated though.</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="n">query</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;INSERT INTO credentials &#39;</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>            <span class="s1">&#39;(username_id, password_id, valid, strict, guessed, guess_time) &#39;</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>            <span class="s1">&#39;SELECT usernames.id, passwords.id, false, false, false, -1 &#39;</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>            <span class="s1">&#39;FROM usernames, passwords &#39;</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>            <span class="s1">&#39;WHERE passwords.sprayable = true&#39;</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>            <span class="s1">&#39; AND usernames.recovered = false&#39;</span><span class="p">)</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="k">if</span> <span class="n">username_values</span><span class="p">:</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>            <span class="n">query</span> <span class="o">+=</span> <span class="n">AND_TEMP</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>                    <span class="n">table</span><span class="o">=</span><span class="s1">&#39;usernames&#39;</span><span class="p">,</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>                    <span class="n">values</span><span class="o">=</span><span class="s1">&#39;&quot;,&quot;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">username_values</span><span class="p">))</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>        <span class="k">if</span> <span class="n">password_values</span><span class="p">:</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>            <span class="n">query</span> <span class="o">+=</span> <span class="n">AND_TEMP</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>                    <span class="n">table</span><span class="o">=</span><span class="s1">&#39;passwords&#39;</span><span class="p">,</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>                    <span class="n">values</span><span class="o">=</span><span class="s1">&#39;&quot;,&quot;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">password_values</span><span class="p">))</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39; ON CONFLICT DO NOTHING;&#39;</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Finished associating spray values.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>    <span class="k">def</span> <span class="nf">delete_password_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">):</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="sd">&#39;&#39;&#39;Delete each password value in the ocntainer from the target</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">        database. Values that do not exist in the database are ignored.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delete_lines</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="c1"># =============================</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>    <span class="c1"># CREDENTIAL MANAGEMENT RECORDS</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>    <span class="c1"># =============================</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>    <span class="k">def</span> <span class="nf">manage_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">is_file</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>            <span class="n">credential_delimiter</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">as_credentials</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="n">insert</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_csv_file</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>            <span class="n">associate_spray_values</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span><span class="n">Logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="sd">&#39;&#39;&#39;Manage credential values in the database.</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">          container: A list of string values to manage. The mutually</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">            exclusive `is_file` and `is_csv_file` flags determine how</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">            values within this container are managed.</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">          credential_delimiter: The sequenct to split credential</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">            records on.</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">          as_credentials: Determines if values being imported should</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">            be treated as strict credentials.</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">          insert: Determines if values should be inserted (`True`) or</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">            deleted (`False`).</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">          is_file: When `True`, treat each value in `container` as a</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">            path to a newline delimited file for processing.</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">          is_csv_file: When `True`, treat each value in `container` as</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">            a CSV file for processing.</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">          associate_spray_values: Indicates if spray values should be</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">            associated after execution.</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">          logger: Logger for events.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">          Exception: when `is_file` and `is_csv_file` are set.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">          - `is_file` and `is_csv_file` are mutually exclusive.</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">          - When both `is_file` and `is_csv_file` are `False`, values</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">            in container are imported directly as credential values.</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>        <span class="k">if</span> <span class="n">is_file</span> <span class="ow">and</span> <span class="n">is_csv_file</span><span class="p">:</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;is_file and is_csv_file are mutually &#39;</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>                <span class="s1">&#39;exclusive.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>        <span class="c1"># ================================</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>        <span class="c1"># DERIVE METHOD AND PREPARE KWARGS</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>        <span class="c1"># ================================</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="n">method</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;insert&#39;</span> <span class="k">if</span> <span class="n">insert</span> <span class="k">else</span> <span class="s1">&#39;delete&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_credential_records&#39;</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>        <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>            <span class="n">as_credentials</span> <span class="o">=</span> <span class="n">as_credentials</span><span class="p">,</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>            <span class="n">credential_delimiter</span> <span class="o">=</span> <span class="n">credential_delimiter</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>        <span class="p">)</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">):</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;associate_spray_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">associate_spray_values</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="c1"># ===================================</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="c1"># CALL THE METHOD BASED ON INPUT TYPE</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="c1"># ===================================</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="k">if</span> <span class="n">is_csv_file</span><span class="p">:</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>            <span class="c1"># ===============================</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>            <span class="c1"># TREAT EACH RECORD AS A CSV FILE</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>            <span class="c1"># ===============================</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                    <span class="n">method</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">reader</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="k">elif</span> <span class="n">is_file</span><span class="p">:</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>            <span class="c1"># ===========================</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>            <span class="c1"># TREAT EACH RECORD AS A FILE</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>            <span class="c1"># ===========================</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>                    <span class="n">method</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>            <span class="n">method</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>        <span class="c1"># This method commits :)</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sync_lookup_tables</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>    <span class="nd">@check_container</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>    <span class="k">def</span> <span class="nf">insert_credential_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="n">as_credentials</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>            <span class="n">credential_delimiter</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">is_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_dictreader</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>            <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>        <span class="sd">&#39;&#39;&#39;Insert credential records into the database. If as_credentials</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">        is True, then only StrictCredential records will be created</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="sd">        for each username to password value. Records will otherwise be</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">        treated as spray values, resulting in each supplied password being</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">        set for guess across all usernames.</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>        <span class="c1"># =================================</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>        <span class="c1"># PREPARE KEY FIELDS FOR CSV INPUTS</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>        <span class="c1"># =================================</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>        <span class="k">if</span> <span class="n">is_file</span><span class="p">:</span> <span class="n">container</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="n">username_key</span><span class="p">,</span> <span class="n">password_key</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="k">if</span> <span class="n">is_dictreader</span><span class="p">:</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>            <span class="n">username_key</span><span class="p">,</span> <span class="n">password_key</span> <span class="o">=</span> \
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>                    <span class="n">scan_dictreader</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">as_credentials</span><span class="p">)</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="k">def</span> <span class="nf">_upsert_values</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>            <span class="c1"># ======================================</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>            <span class="c1"># BREAK THE RECORDS DOWN INTO CONTAINERS</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>            <span class="c1"># ======================================</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="n">credentials</span><span class="p">,</span> <span class="n">usernames</span><span class="p">,</span> <span class="n">passwords</span> <span class="o">=</span> \
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>                <span class="n">split_credential_container</span><span class="p">(</span><span class="n">chunk</span><span class="p">,</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>                    <span class="n">username_key</span><span class="o">=</span><span class="n">username_key</span><span class="p">,</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>                    <span class="n">password_key</span><span class="o">=</span><span class="n">password_key</span><span class="p">,</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>                    <span class="n">credential_delimiter</span><span class="o">=</span><span class="n">credential_delimiter</span><span class="p">,</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>                    <span class="n">as_credentials</span><span class="o">=</span><span class="n">as_credentials</span><span class="p">)</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>            <span class="c1"># ================</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>            <span class="c1"># UPSERT USERNAMES</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>            <span class="c1"># ================</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">,</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>                <span class="n">values</span> <span class="o">=</span> <span class="n">usernames</span><span class="p">)</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>            <span class="c1"># ================</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>            <span class="c1"># UPSERT PASSWORDS</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>            <span class="c1"># ================</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">as_credentials</span><span class="p">:</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>                <span class="c1"># Sprayable passwords</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>                  <span class="c1"># Also updates currently existing non-sprayable passwords</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>                  <span class="c1"># to become sprayable.</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">,</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>                    <span class="n">values</span> <span class="o">=</span> <span class="n">passwords</span><span class="p">,</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>                    <span class="n">do_update_where</span> <span class="o">=</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>                        <span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">sprayable</span> <span class="o">==</span> <span class="kc">False</span><span class="p">),</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>                    <span class="n">update_data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">sprayable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>                <span class="c1"># ======================</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>                <span class="c1"># ASSOCIATE SPRAY VALUES</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>                <span class="c1"># ======================</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>                <span class="c1"># Commit current database changes</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>                <span class="c1"># Translate lists of dictionaries to</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>                <span class="c1"># lists of strings</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>                <span class="n">flatten_dict_values</span><span class="p">(</span><span class="n">usernames</span><span class="p">)</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>                <span class="n">flatten_dict_values</span><span class="p">(</span><span class="n">passwords</span><span class="p">)</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>                <span class="c1"># Associate the newly inserted values</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>                <span class="k">if</span> <span class="n">associate_spray_values</span><span class="p">:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                    <span class="c1"># Set spray values for new usernames</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">associate_spray_values</span><span class="p">(</span><span class="n">username_values</span><span class="o">=</span><span class="n">usernames</span><span class="p">)</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>                    <span class="c1"># Set spray values for these passwords to all usernames</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">associate_spray_values</span><span class="p">(</span><span class="n">password_values</span><span class="o">=</span><span class="n">passwords</span><span class="p">)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>                <span class="c1"># Non-sprayable passwords</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">,</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>                    <span class="n">values</span> <span class="o">=</span> <span class="n">passwords</span><span class="p">)</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>                <span class="c1"># Free up memory</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>                <span class="n">usernames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">credentials</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>                <span class="k">del</span><span class="p">(</span><span class="n">passwords</span><span class="p">)</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>                <span class="c1"># Commit database changes</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>                <span class="c1"># ===============================</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>                <span class="c1"># CREATE CREDENTIAL RECORD VALUES</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>                <span class="c1"># ===============================</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>                <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>                <span class="k">for</span> <span class="n">username</span> <span class="ow">in</span> <span class="n">usernames</span><span class="p">:</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>                    <span class="n">passwords</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="n">username</span><span class="p">]</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>                    <span class="k">del</span><span class="p">(</span><span class="n">credentials</span><span class="p">[</span><span class="n">username</span><span class="p">])</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>                    <span class="c1"># ===============================</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>                    <span class="c1"># CREATE CREDENTIAL RECORD VALUES</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>                    <span class="c1"># ===============================</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>                    <span class="n">username</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span> \
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>                        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">username</span><span class="p">)</span> \
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>                        <span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>                    <span class="k">for</span> <span class="n">password</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span> \
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>                            <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">passwords</span><span class="p">)):</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>                        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>                            <span class="n">username_id</span> <span class="o">=</span> <span class="n">username</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>                            <span class="n">password_id</span> <span class="o">=</span> <span class="n">password</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>                            <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>                <span class="c1"># =============================</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>                <span class="c1"># UPSERT THE CREDENTIAL RECORDS</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>                <span class="c1"># =============================</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">,</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>                    <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>                    <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;username_id&#39;</span><span class="p">,</span> <span class="s1">&#39;password_id&#39;</span><span class="p">])</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>                <span class="k">if</span> <span class="n">associate_spray_values</span><span class="p">:</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>                    <span class="c1"># Associate all sprayable passwords back to the new</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>                    <span class="c1"># username values</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">associate_spray_values</span><span class="p">(</span><span class="n">username_values</span><span class="o">=</span><span class="n">usernames</span><span class="p">)</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>        <span class="n">chunk_container</span><span class="p">(</span><span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>            <span class="n">callback</span> <span class="o">=</span> <span class="n">_upsert_values</span><span class="p">,</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>            <span class="n">is_file</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">is_dictreader</span> <span class="ow">and</span> <span class="n">is_file</span><span class="p">)</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>    <span class="k">def</span> <span class="nf">sync_lookup_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span><span class="n">Logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>        <span class="sd">&#39;&#39;&#39;Update the sql.StrictCredential and sql.PriorityCredential tables</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">        with reference to the proper credential values.</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">        sql.StrictCredential and sql.PriorityCredential are lookup tables</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">        intended to be more efficiently refrenced than sql.Credental, which</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">        contains all possible credential records. This means quicker query</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">        response.</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">            logger: Logger instance to support event logging.</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>        <span class="k">def</span> <span class="nf">_upsert_strict_creds</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>                <span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">StrictCredential</span><span class="p">,</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>                <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;credential_id&#39;</span><span class="p">],</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>                <span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>                    <span class="nb">dict</span><span class="p">(</span><span class="n">credential_id</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">chunk</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>                <span class="p">])</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>        <span class="k">def</span> <span class="nf">_upsert_priority_creds</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>                <span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">PriorityCredential</span><span class="p">,</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>                <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;credential_id&#39;</span><span class="p">],</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>                <span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>                    <span class="nb">dict</span><span class="p">(</span><span class="n">credential_id</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">chunk</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>                <span class="p">])</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>        <span class="c1"># ==============================</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>        <span class="c1"># TODO: MAKE THIS MORE EFFICIENT</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>        <span class="c1"># ==============================</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>        <span class="c1"># Clear the lookup tables to start fresh</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>        <span class="c1">#  - We do this because some passwords may have been altered</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>        <span class="c1">#    since the last run</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">StrictCredential</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">PriorityCredential</span><span class="p">,):</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">delete</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>        <span class="c1"># ==================</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>        <span class="c1"># STRICT CREDENTIALS</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>        <span class="c1"># ==================</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="s1">&#39;Linking strict credentials&#39;</span><span class="p">)</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>        <span class="n">strict_query</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>                <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">)</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>                <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">strict</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>        <span class="p">)</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>        <span class="n">chunk_container</span><span class="p">(</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">strict_query</span><span class="p">,</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>            <span class="n">callback</span> <span class="o">=</span> <span class="n">_upsert_strict_creds</span><span class="p">)</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>        <span class="c1"># ====================</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>        <span class="c1"># PRIORITY CREDENTIALS</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>        <span class="c1"># ====================</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="s1">&#39;Linking priority credentials&#39;</span><span class="p">)</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>        <span class="n">priority_query</span> <span class="o">=</span> <span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>            <span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>                <span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">password_id</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>                    <span class="n">select</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>                        <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">priority</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>                <span class="p">)</span> <span class="o">|</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>                <span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">username_id</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>                    <span class="n">select</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>                        <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">priority</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>                <span class="p">)</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>            <span class="p">))</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>        <span class="n">chunk_container</span><span class="p">(</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>            <span class="n">container</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">priority_query</span><span class="p">),</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>            <span class="n">callback</span> <span class="o">=</span> <span class="n">_upsert_priority_creds</span><span class="p">)</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>    <span class="nd">@check_container</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>    <span class="k">def</span> <span class="nf">delete_credential_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>            <span class="n">as_credentials</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>            <span class="n">credential_delimiter</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">is_file</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>            <span class="n">is_dictreader</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>        <span class="sd">&#39;&#39;&#39;Delete credential records from the target database.</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>        <span class="k">if</span> <span class="n">is_file</span><span class="p">:</span> <span class="n">container</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>        <span class="n">username_key</span><span class="p">,</span> <span class="n">password_key</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>        <span class="k">if</span> <span class="n">is_dictreader</span><span class="p">:</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>            <span class="n">username_key</span><span class="p">,</span> <span class="n">password_key</span> <span class="o">=</span> <span class="n">scan_dictreader</span><span class="p">(</span><span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>                <span class="n">as_credentials</span><span class="p">)</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>        <span class="k">def</span> <span class="nf">_delete_values</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>            <span class="n">credentials</span><span class="p">,</span> <span class="n">usernames</span><span class="p">,</span> <span class="n">passwords</span> <span class="o">=</span> \
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>                <span class="n">split_credential_container</span><span class="p">(</span><span class="n">chunk</span><span class="p">,</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>                    <span class="n">username_key</span><span class="o">=</span><span class="n">username_key</span><span class="p">,</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>                    <span class="n">password_key</span><span class="o">=</span><span class="n">password_key</span><span class="p">,</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>                    <span class="n">as_credentials</span><span class="o">=</span><span class="n">as_credentials</span><span class="p">)</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>            <span class="k">if</span> <span class="n">as_credentials</span><span class="p">:</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>                <span class="c1"># ==========================</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>                <span class="c1"># DESTROY CREDENTIAL RECORDS</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>                <span class="c1"># ==========================</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>                <span class="k">del</span><span class="p">(</span><span class="n">usernames</span><span class="p">)</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>                <span class="k">del</span><span class="p">(</span><span class="n">passwords</span><span class="p">)</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>                <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>                <span class="k">for</span> <span class="n">username</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">credentials</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>                    <span class="c1"># ================================</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>                    <span class="c1"># COLLECT CREDENTIALS FOR THE USER</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>                    <span class="c1"># ================================</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>                    <span class="n">ids</span> <span class="o">+=</span> <span class="p">[</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>                        <span class="n">i</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">)</span> \
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>                            <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span> \
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>                            <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span> \
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>                            <span class="o">.</span><span class="n">filter</span><span class="p">(</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>                                <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">username</span><span class="p">,</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>                                <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>                                    <span class="n">credentials</span><span class="p">[</span><span class="n">username</span><span class="p">]),</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>                                <span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">guessed</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>                    <span class="p">]</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>                <span class="c1"># ======================</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>                <span class="c1"># APPLY THE DELETE QUERY</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>                <span class="c1"># ======================</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>                    <span class="n">delete</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">)</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>                        <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">ids</span><span class="p">)))</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>                <span class="c1"># ================================</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>                <span class="c1"># DESTROY USERNAME/PASSWORD VALUES</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>                <span class="c1"># ================================</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>                <span class="n">flatten_dict_values</span><span class="p">(</span><span class="n">usernames</span><span class="p">)</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>                <span class="n">flatten_dict_values</span><span class="p">(</span><span class="n">passwords</span><span class="p">)</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>                <span class="k">if</span> <span class="n">usernames</span><span class="p">:</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">delete_lines</span><span class="p">(</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>                        <span class="n">container</span><span class="o">=</span><span class="n">usernames</span><span class="p">,</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>                        <span class="n">model</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>                <span class="k">if</span> <span class="n">passwords</span><span class="p">:</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">delete_lines</span><span class="p">(</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>                        <span class="n">container</span><span class="o">=</span><span class="n">passwords</span><span class="p">,</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>                        <span class="n">model</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>        <span class="n">chunk_container</span><span class="p">(</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>            <span class="n">callback</span> <span class="o">=</span> <span class="n">_delete_values</span><span class="p">)</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="c1"># =======================================</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="c1"># DELETE ORPHANED NON-SPRAYABLE PASSWORDS</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>        <span class="c1"># =======================================</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>        <span class="n">aPass</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>        <span class="n">aCred</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">)</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>        <span class="n">query</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> \
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>            <span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span> \
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>            <span class="o">.</span><span class="n">select_from</span><span class="p">(</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>                <span class="n">join</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">))</span> \
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>            <span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>                <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">sprayable</span> <span class="o">==</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>                <span class="n">not_</span><span class="p">(</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>                    <span class="n">select</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">password_id</span><span class="p">)</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>                        <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aPass</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">aCred</span><span class="o">.</span><span class="n">password_id</span><span class="p">)</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>                        <span class="o">.</span><span class="n">exists</span><span class="p">()))</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>        <span class="c1"># Get the password ids</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>        <span class="n">ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>        <span class="k">if</span> <span class="n">ids</span><span class="p">:</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>            <span class="c1"># Flatten the row tuples</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)):</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>                <span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>            <span class="c1"># Delete the records</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>                <span class="n">delete</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>                    <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">ids</span><span class="p">)))</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>    <span class="k">def</span> <span class="nf">get_or_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>        <span class="sd">&#39;&#39;&#39;Get or create an individual database instance, the return</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">        value.</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>        <span class="n">instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> \
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>                <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">value</span><span class="p">)</span> \
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>                <span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>        <span class="k">if</span> <span class="n">instance</span><span class="p">:</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">instance</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>            <span class="n">instance</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">instance</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>    <span class="n">goc</span> <span class="o">=</span> <span class="n">get_or_create</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>    <span class="k">def</span> <span class="nf">manage_priorities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usernames</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>            <span class="n">passwords</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prioritize</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>            <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>        <span class="sd">&#39;&#39;&#39;Prioritize or deprioritize database values.</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">          usernames: A list of string username values.</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">          passwords: A list of string password values.</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">          prioritize: Boolean determining if the values should be</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">            prioritized or deprioritized.</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">usernames</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">passwords</span><span class="p">:</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;usernames or passwords required&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>        <span class="n">usernames</span> <span class="o">=</span> <span class="n">usernames</span> <span class="k">if</span> <span class="n">usernames</span> <span class="o">!=</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>        <span class="n">passwords</span> <span class="o">=</span> <span class="n">passwords</span> <span class="k">if</span> <span class="n">passwords</span> <span class="o">!=</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>        <span class="k">if</span> <span class="n">usernames</span><span class="p">:</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>            <span class="c1"># Manage username priorities</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>                <span class="n">update</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>                    <span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>                        <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">usernames</span><span class="p">))</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>                    <span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">priority</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>        <span class="k">if</span> <span class="n">passwords</span><span class="p">:</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>            <span class="c1"># Manage password priorities</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>                <span class="n">update</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>                    <span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>                        <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">passwords</span><span class="p">))</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>                    <span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">priority</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>        <span class="c1"># This method commits :)</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sync_lookup_tables</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>    <span class="k">def</span> <span class="nf">manage_db_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">usernames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>            <span class="n">passwords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">username_files</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password_files</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>            <span class="n">credentials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credential_files</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>            <span class="n">credential_delimiter</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">as_credentials</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>            <span class="n">csv_files</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>            <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>        <span class="c1"># ===============</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>        <span class="c1"># VALIDATE INPUTS</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>        <span class="c1"># ===============</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">usernames</span><span class="p">,</span><span class="n">passwords</span><span class="p">,</span><span class="n">username_files</span><span class="p">,</span><span class="n">password_files</span><span class="p">,</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>                <span class="n">credentials</span><span class="p">,</span><span class="n">credential_files</span><span class="p">]:</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>            <span class="k">if</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">v</span><span class="p">):</span> <span class="k">continue</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>                    <span class="s1">&#39;Username/Password arguments must be iterable values &#39;</span> \
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>                    <span class="s1">&#39;populated with string records or file names&#39;</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>                <span class="p">)</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>        <span class="c1"># Make sure that only credential inputs are allowed when the</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>        <span class="c1"># as_credentials flag is set to true</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>        <span class="k">if</span> <span class="n">as_credentials</span><span class="p">:</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Only credentials or credential_files can be supplied &#39;</span> \
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>                  <span class="s1">&#39;when using the as_credentials flag is set to True&#39;</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>            <span class="k">if</span> <span class="n">usernames</span> <span class="ow">or</span> <span class="n">passwords</span> <span class="ow">or</span> <span class="n">username_files</span> <span class="ow">or</span> \
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>                    <span class="n">password_files</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">usernames</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">username_files</span> <span class="ow">and</span> \
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>                <span class="ow">not</span> <span class="n">passwords</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">password_files</span> <span class="ow">and</span> \
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>                <span class="ow">not</span> <span class="n">credentials</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">credential_files</span> <span class="ow">and</span> \
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>                <span class="ow">not</span> <span class="n">csv_files</span> <span class="ow">and</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;No values to manage supplied to db manager&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>            <span class="k">return</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>        <span class="c1"># ===============</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>        <span class="c1"># BEGIN EXECUTION</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>        <span class="c1"># ===============</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Starting db management. Action: &#39;</span> <span class="o">+</span> \
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>                <span class="p">(</span><span class="s1">&#39;INSERT&#39;</span> <span class="k">if</span> <span class="n">insert</span> <span class="k">else</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">))</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>        <span class="c1"># ===================</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>        <span class="c1"># HANDLE SPRAY VALUES</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>        <span class="c1"># ===================</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>        <span class="k">if</span> <span class="n">usernames</span><span class="p">:</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Managing usernames: </span><span class="si">{</span><span class="n">usernames</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">manage_values</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">,</span> <span class="n">usernames</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="n">insert</span><span class="p">,</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>                    <span class="n">associate_spray_values</span><span class="o">=</span><span class="n">associate_spray_values</span><span class="p">,</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>        <span class="k">if</span> <span class="n">passwords</span><span class="p">:</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Managing passwords: </span><span class="si">{</span><span class="n">passwords</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">manage_values</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">,</span> <span class="n">passwords</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="n">insert</span><span class="p">,</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>                    <span class="n">associate_spray_values</span><span class="o">=</span><span class="n">associate_spray_values</span><span class="p">,</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>        <span class="k">if</span> <span class="n">username_files</span><span class="p">:</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Managing username files: </span><span class="si">{</span><span class="n">username_files</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">manage_values</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">,</span> <span class="n">username_files</span><span class="p">,</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>                    <span class="n">is_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="n">insert</span><span class="p">,</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>                    <span class="n">associate_spray_values</span><span class="o">=</span><span class="n">associate_spray_values</span><span class="p">,</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>        <span class="k">if</span> <span class="n">password_files</span><span class="p">:</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Managing password files: </span><span class="si">{</span><span class="n">password_files</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">manage_values</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">,</span> <span class="n">password_files</span><span class="p">,</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>                    <span class="n">is_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="n">insert</span><span class="p">,</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>                    <span class="n">associate_spray_values</span><span class="o">=</span><span class="n">associate_spray_values</span><span class="p">,</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>        <span class="c1"># ========================</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>        <span class="c1"># HANDLE CREDENTIAL VALUES</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>        <span class="c1"># ========================</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>        <span class="k">if</span> <span class="n">credentials</span><span class="p">:</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Managing credentials: </span><span class="si">{</span><span class="n">credentials</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">manage_credentials</span><span class="p">(</span><span class="n">credentials</span><span class="p">,</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>                    <span class="n">as_credentials</span><span class="o">=</span><span class="n">as_credentials</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="n">insert</span><span class="p">,</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>                    <span class="n">associate_spray_values</span><span class="o">=</span><span class="n">associate_spray_values</span><span class="p">,</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>                    <span class="n">credential_delimiter</span><span class="o">=</span><span class="n">credential_delimiter</span><span class="p">)</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>        <span class="k">if</span> <span class="n">credential_files</span><span class="p">:</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>                    <span class="sa">f</span><span class="s1">&#39;Managing credential files: </span><span class="si">{</span><span class="n">credential_files</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">manage_credentials</span><span class="p">(</span><span class="n">credential_files</span><span class="p">,</span> <span class="n">is_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>                    <span class="n">as_credentials</span><span class="o">=</span><span class="n">as_credentials</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="n">insert</span><span class="p">,</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>                    <span class="n">associate_spray_values</span><span class="o">=</span><span class="n">associate_spray_values</span><span class="p">,</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>                    <span class="n">credential_delimiter</span><span class="o">=</span><span class="n">credential_delimiter</span><span class="p">,</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>        <span class="k">if</span> <span class="n">csv_files</span><span class="p">:</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>                    <span class="sa">f</span><span class="s1">&#39;Managing CSV credential files: </span><span class="si">{</span><span class="n">csv_files</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">manage_credentials</span><span class="p">(</span><span class="n">csv_files</span><span class="p">,</span> <span class="n">is_csv_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>                    <span class="n">as_credentials</span><span class="o">=</span><span class="n">as_credentials</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="n">insert</span><span class="p">,</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>                    <span class="n">associate_spray_values</span><span class="o">=</span><span class="n">associate_spray_values</span><span class="p">,</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>                    <span class="n">credential_delimiter</span><span class="o">=</span><span class="n">credential_delimiter</span><span class="p">,</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>    <span class="k">def</span> <span class="nf">get_valid_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>        <span class="sd">&#39;&#39;&#39;Return valid credentials</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>        <span class="c1"># Normal credentials</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>        <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">)</span> \
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>                <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">valid</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> \
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>                <span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>        <span class="k">return</span> <span class="n">valids</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>    <span class="k">def</span> <span class="nf">get_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>        <span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">)</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>        <span class="k">if</span> <span class="n">strict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>            <span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">strict</span> <span class="o">==</span> <span class="n">strict</span><span class="p">)</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>        <span class="k">return</span> <span class="n">query</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>    <span class="k">def</span> <span class="nf">get_strict_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>        <span class="sd">&#39;&#39;&#39;Return strict credential records.</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_credentials</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.associate_spray_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">associate_spray_values</span><span class="p">(</span><span class="n">username_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Create records in the credentials association table for
spray values.</p>
<p>When called <em>without</em> <code>username</code> and/or <code>password</code> values,
association records will be created for all sprayable
passwords and accounts that have not yet been recovered.</p>
<p>When called with <code>username</code> and/or <code>password</code> arguments,
only create association records where their values are
matched in their respective tables. This makes insertion
significantly more efficient.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>username_values</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td><p>A list of username values to associate.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>password_values</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td><p>A list of string password values to
associate.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>logger</code></td>
          <td>
                <code><span title="logging.Logger">Logger</span></code>
          </td>
          <td><p>Logger instance.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="k">def</span> <span class="nf">associate_spray_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username_values</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="n">password_values</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span><span class="n">Logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>    <span class="sd">&#39;&#39;&#39;Create records in the credentials association table for</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">    spray values.</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">    When called _without_ `username` and/or `password` values,</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">    association records will be created for all sprayable</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">    passwords and accounts that have not yet been recovered.</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">    When called with `username` and/or `password` arguments,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">    only create association records where their values are</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">    matched in their respective tables. This makes insertion</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">    significantly more efficient.</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">      username_values: A list of username values to associate.</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">      password_values: A list of string password values to</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">        associate.</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">      logger: Logger instance.</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>    <span class="n">AND_TEMP</span> <span class="o">=</span> <span class="s1">&#39; AND </span><span class="si">{table}</span><span class="s1">.value IN (&quot;</span><span class="si">{values}</span><span class="s1">&quot;)&#39;</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Associating spray values.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="c1"># TODO: Update this to use the ORM. It&#39;s complicated though.</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>    <span class="n">query</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;INSERT INTO credentials &#39;</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="s1">&#39;(username_id, password_id, valid, strict, guessed, guess_time) &#39;</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>        <span class="s1">&#39;SELECT usernames.id, passwords.id, false, false, false, -1 &#39;</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="s1">&#39;FROM usernames, passwords &#39;</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="s1">&#39;WHERE passwords.sprayable = true&#39;</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="s1">&#39; AND usernames.recovered = false&#39;</span><span class="p">)</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>    <span class="k">if</span> <span class="n">username_values</span><span class="p">:</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="n">query</span> <span class="o">+=</span> <span class="n">AND_TEMP</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>                <span class="n">table</span><span class="o">=</span><span class="s1">&#39;usernames&#39;</span><span class="p">,</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>                <span class="n">values</span><span class="o">=</span><span class="s1">&#39;&quot;,&quot;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">username_values</span><span class="p">))</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>    <span class="k">if</span> <span class="n">password_values</span><span class="p">:</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="n">query</span> <span class="o">+=</span> <span class="n">AND_TEMP</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>                <span class="n">table</span><span class="o">=</span><span class="s1">&#39;passwords&#39;</span><span class="p">,</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>                <span class="n">values</span><span class="o">=</span><span class="s1">&#39;&quot;,&quot;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">password_values</span><span class="p">))</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>    <span class="n">query</span> <span class="o">+=</span> <span class="s1">&#39; ON CONFLICT DO NOTHING;&#39;</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Finished associating spray values.&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.delete_credential_records" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_credential_records</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">as_credentials</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">credential_delimiter</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">is_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_dictreader</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Delete credential records from the target database.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="nd">@check_container</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="k">def</span> <span class="nf">delete_credential_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>        <span class="n">as_credentials</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>        <span class="n">credential_delimiter</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">is_file</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>        <span class="n">is_dictreader</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>    <span class="sd">&#39;&#39;&#39;Delete credential records from the target database.</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>    <span class="k">if</span> <span class="n">is_file</span><span class="p">:</span> <span class="n">container</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>    <span class="n">username_key</span><span class="p">,</span> <span class="n">password_key</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>    <span class="k">if</span> <span class="n">is_dictreader</span><span class="p">:</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>        <span class="n">username_key</span><span class="p">,</span> <span class="n">password_key</span> <span class="o">=</span> <span class="n">scan_dictreader</span><span class="p">(</span><span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>            <span class="n">as_credentials</span><span class="p">)</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>    <span class="k">def</span> <span class="nf">_delete_values</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>        <span class="n">credentials</span><span class="p">,</span> <span class="n">usernames</span><span class="p">,</span> <span class="n">passwords</span> <span class="o">=</span> \
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>            <span class="n">split_credential_container</span><span class="p">(</span><span class="n">chunk</span><span class="p">,</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>                <span class="n">username_key</span><span class="o">=</span><span class="n">username_key</span><span class="p">,</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>                <span class="n">password_key</span><span class="o">=</span><span class="n">password_key</span><span class="p">,</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>                <span class="n">as_credentials</span><span class="o">=</span><span class="n">as_credentials</span><span class="p">)</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>        <span class="k">if</span> <span class="n">as_credentials</span><span class="p">:</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>            <span class="c1"># ==========================</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>            <span class="c1"># DESTROY CREDENTIAL RECORDS</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>            <span class="c1"># ==========================</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>            <span class="k">del</span><span class="p">(</span><span class="n">usernames</span><span class="p">)</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>            <span class="k">del</span><span class="p">(</span><span class="n">passwords</span><span class="p">)</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>            <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>            <span class="k">for</span> <span class="n">username</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">credentials</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>                <span class="c1"># ================================</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>                <span class="c1"># COLLECT CREDENTIALS FOR THE USER</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>                <span class="c1"># ================================</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>                <span class="n">ids</span> <span class="o">+=</span> <span class="p">[</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>                    <span class="n">i</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">)</span> \
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>                        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span> \
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>                        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span> \
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>                        <span class="o">.</span><span class="n">filter</span><span class="p">(</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>                            <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">username</span><span class="p">,</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>                            <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>                                <span class="n">credentials</span><span class="p">[</span><span class="n">username</span><span class="p">]),</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>                            <span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">guessed</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>                <span class="p">]</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>            <span class="c1"># ======================</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>            <span class="c1"># APPLY THE DELETE QUERY</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>            <span class="c1"># ======================</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>                <span class="n">delete</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">)</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>                    <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">ids</span><span class="p">)))</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>            <span class="c1"># ================================</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>            <span class="c1"># DESTROY USERNAME/PASSWORD VALUES</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>            <span class="c1"># ================================</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>            <span class="n">flatten_dict_values</span><span class="p">(</span><span class="n">usernames</span><span class="p">)</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>            <span class="n">flatten_dict_values</span><span class="p">(</span><span class="n">passwords</span><span class="p">)</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>            <span class="k">if</span> <span class="n">usernames</span><span class="p">:</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">delete_lines</span><span class="p">(</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>                    <span class="n">container</span><span class="o">=</span><span class="n">usernames</span><span class="p">,</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>                    <span class="n">model</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>            <span class="k">if</span> <span class="n">passwords</span><span class="p">:</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">delete_lines</span><span class="p">(</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>                    <span class="n">container</span><span class="o">=</span><span class="n">passwords</span><span class="p">,</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>                    <span class="n">model</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>    <span class="n">chunk_container</span><span class="p">(</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>        <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>        <span class="n">callback</span> <span class="o">=</span> <span class="n">_delete_values</span><span class="p">)</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>    <span class="c1"># =======================================</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>    <span class="c1"># DELETE ORPHANED NON-SPRAYABLE PASSWORDS</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>    <span class="c1"># =======================================</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>    <span class="n">aPass</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>    <span class="n">aCred</span> <span class="o">=</span> <span class="n">aliased</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">)</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>    <span class="n">query</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> \
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>        <span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span> \
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>        <span class="o">.</span><span class="n">select_from</span><span class="p">(</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>            <span class="n">join</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">))</span> \
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>        <span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>            <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">sprayable</span> <span class="o">==</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>            <span class="n">not_</span><span class="p">(</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>                <span class="n">select</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">password_id</span><span class="p">)</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>                    <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aPass</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">aCred</span><span class="o">.</span><span class="n">password_id</span><span class="p">)</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>                    <span class="o">.</span><span class="n">exists</span><span class="p">()))</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>    <span class="c1"># Get the password ids</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>    <span class="n">ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>    <span class="k">if</span> <span class="n">ids</span><span class="p">:</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>        <span class="c1"># Flatten the row tuples</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)):</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>            <span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>        <span class="c1"># Delete the records</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>            <span class="n">delete</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>                <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">ids</span><span class="p">)))</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.delete_lines" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_lines</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Delete lines from <code>container</code>.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="k">def</span> <span class="nf">delete_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="sd">&#39;&#39;&#39;Delete lines from `container`.</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="k">def</span> <span class="nf">_delete_values</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="n">delete</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">chunk</span><span class="p">)))</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="n">chunk_container</span><span class="p">(</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="n">callback</span> <span class="o">=</span> <span class="n">_delete_values</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.delete_password_records" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_password_records</span><span class="p">(</span><span class="n">container</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Delete each password value in the ocntainer from the target
database. Values that do not exist in the database are ignored.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="k">def</span> <span class="nf">delete_password_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">):</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="sd">&#39;&#39;&#39;Delete each password value in the ocntainer from the target</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">    database. Values that do not exist in the database are ignored.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">delete_lines</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.delete_username_records" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_username_records</span><span class="p">(</span><span class="n">container</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Delete each username value in the container from the target
database. Values that do not exist in the database are ignored.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="k">def</span> <span class="nf">delete_username_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">):</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="sd">&#39;&#39;&#39;Delete each username value in the container from the target</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">    database. Values that do not exist in the database are ignored.</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">delete_lines</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.disable_username_records" class="doc doc-heading">
<code class="highlight language-python"><span class="n">disable_username_records</span><span class="p">(</span><span class="n">container</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Set the actionable attribute on each record in the container
to False, removing them from further guesses.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="k">def</span> <span class="nf">disable_username_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">):</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="sd">&#39;&#39;&#39;Set the actionable attribute on each record in the container</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    to False, removing them from further guesses.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">update</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>                <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">container</span><span class="p">),</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>                <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">actionable</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">actionable</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.do_upsert" class="doc doc-heading">
<code class="highlight language-python"><span class="n">do_upsert</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span> <span class="n">do_update_where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Insert values into a model (database table) via upsert.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>SQLAlchemy ORM model.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>values</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>Values to insert into the database table.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>do_update_where</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Condition that determines if records
should be updated during the upsert, e.g.
sql.Password.sprayable == False. When supplied, only
records matching the condition will be altered.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>update_data</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Dictionary of field to value mappings used to
update fields.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>logger</code></td>
          <td>
                <code><span title="logging.Logger">Logger</span></code>
          </td>
          <td><p>Logger instance used to send log events.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="k">def</span> <span class="nf">do_upsert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="n">index_elements</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="n">do_update_where</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_data</span><span class="p">:</span><span class="nb">dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="n">logger</span><span class="p">:</span><span class="n">Logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="sd">&#39;&#39;&#39;Insert values into a model (database table) via upsert.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">      model: SQLAlchemy ORM model.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">      values: Values to insert into the database table.</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">      do_update_where: Condition that determines if records</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        should be updated during the upsert, e.g.</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        sql.Password.sprayable == False. When supplied, only</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        records matching the condition will be altered.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">      update_data: Dictionary of field to value mappings used to</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        update fields.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">      logger: Logger instance used to send log events.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="c1"># https://docs.sqlalchemy.org/en/14/dialects/sqlite.html#insert-on-conflict-upsert</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">s</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="k">if</span> <span class="n">do_update_where</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">update_data</span><span class="p">:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="c1"># TODO: Perform checks on do_update where</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="c1"># must be a query, I think.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">update_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>                <span class="sa">f</span><span class="s1">&#39;update_data must be a dictionary of data&#39;</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">on_conflict_do_update</span><span class="p">(</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="n">index_elements</span><span class="o">=</span><span class="n">index_elements</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">where</span><span class="o">=</span><span class="n">do_update_where</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="n">set_</span><span class="o">=</span><span class="n">update_data</span><span class="p">)</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">on_conflict_do_nothing</span><span class="p">(</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>            <span class="n">index_elements</span><span class="o">=</span><span class="n">index_elements</span><span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">begin_nested</span><span class="p">():</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Failed to upsert values: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.enable_username_records" class="doc doc-heading">
<code class="highlight language-python"><span class="n">enable_username_records</span><span class="p">(</span><span class="n">container</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Set the actionable attribute on each record in the container
to True, ensuring they will be targeted for further guesses.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="k">def</span> <span class="nf">enable_username_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">):</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="sd">&#39;&#39;&#39;Set the actionable attribute on each record in the container</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">    to True, ensuring they will be targeted for further guesses.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="n">update</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>            <span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">container</span><span class="p">),</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">actionable</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">actionable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.get_or_create" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_or_create</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get or create an individual database instance, the return
value.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="k">def</span> <span class="nf">get_or_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>    <span class="sd">&#39;&#39;&#39;Get or create an individual database instance, the return</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">    value.</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>    <span class="n">instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> \
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>            <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">value</span><span class="p">)</span> \
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>            <span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>    <span class="k">if</span> <span class="n">instance</span><span class="p">:</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">instance</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>        <span class="n">instance</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">instance</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.get_strict_credentials" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_strict_credentials</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return strict credential records.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="k">def</span> <span class="nf">get_strict_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>    <span class="sd">&#39;&#39;&#39;Return strict credential records.</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_credentials</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.get_valid_credentials" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_valid_credentials</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return valid credentials</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="k">def</span> <span class="nf">get_valid_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>    <span class="sd">&#39;&#39;&#39;Return valid credentials</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>    <span class="c1"># Normal credentials</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>    <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">)</span> \
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>            <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">valid</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> \
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>            <span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>    <span class="k">return</span> <span class="n">valids</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.insert_credential_records" class="doc doc-heading">
<code class="highlight language-python"><span class="n">insert_credential_records</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">as_credentials</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">credential_delimiter</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">is_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_dictreader</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Insert credential records into the database. If as_credentials
is True, then only StrictCredential records will be created
for each username to password value. Records will otherwise be
treated as spray values, resulting in each supplied password being
set for guess across all usernames.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="nd">@check_container</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="k">def</span> <span class="nf">insert_credential_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="n">as_credentials</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>        <span class="n">credential_delimiter</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">is_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_dictreader</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>    <span class="sd">&#39;&#39;&#39;Insert credential records into the database. If as_credentials</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">    is True, then only StrictCredential records will be created</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="sd">    for each username to password value. Records will otherwise be</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">    treated as spray values, resulting in each supplied password being</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">    set for guess across all usernames.</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>    <span class="c1"># =================================</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>    <span class="c1"># PREPARE KEY FIELDS FOR CSV INPUTS</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>    <span class="c1"># =================================</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>    <span class="k">if</span> <span class="n">is_file</span><span class="p">:</span> <span class="n">container</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="n">username_key</span><span class="p">,</span> <span class="n">password_key</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>    <span class="k">if</span> <span class="n">is_dictreader</span><span class="p">:</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>        <span class="n">username_key</span><span class="p">,</span> <span class="n">password_key</span> <span class="o">=</span> \
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>                <span class="n">scan_dictreader</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">as_credentials</span><span class="p">)</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>    <span class="k">def</span> <span class="nf">_upsert_values</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>        <span class="c1"># ======================================</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>        <span class="c1"># BREAK THE RECORDS DOWN INTO CONTAINERS</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="c1"># ======================================</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="n">credentials</span><span class="p">,</span> <span class="n">usernames</span><span class="p">,</span> <span class="n">passwords</span> <span class="o">=</span> \
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>            <span class="n">split_credential_container</span><span class="p">(</span><span class="n">chunk</span><span class="p">,</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>                <span class="n">username_key</span><span class="o">=</span><span class="n">username_key</span><span class="p">,</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>                <span class="n">password_key</span><span class="o">=</span><span class="n">password_key</span><span class="p">,</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>                <span class="n">credential_delimiter</span><span class="o">=</span><span class="n">credential_delimiter</span><span class="p">,</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>                <span class="n">as_credentials</span><span class="o">=</span><span class="n">as_credentials</span><span class="p">)</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>        <span class="c1"># ================</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="c1"># UPSERT USERNAMES</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="c1"># ================</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">,</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>            <span class="n">values</span> <span class="o">=</span> <span class="n">usernames</span><span class="p">)</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>        <span class="c1"># ================</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>        <span class="c1"># UPSERT PASSWORDS</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>        <span class="c1"># ================</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">as_credentials</span><span class="p">:</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>            <span class="c1"># Sprayable passwords</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>              <span class="c1"># Also updates currently existing non-sprayable passwords</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>              <span class="c1"># to become sprayable.</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">,</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>                <span class="n">values</span> <span class="o">=</span> <span class="n">passwords</span><span class="p">,</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>                <span class="n">do_update_where</span> <span class="o">=</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>                    <span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">sprayable</span> <span class="o">==</span> <span class="kc">False</span><span class="p">),</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>                <span class="n">update_data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">sprayable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>            <span class="c1"># ======================</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>            <span class="c1"># ASSOCIATE SPRAY VALUES</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>            <span class="c1"># ======================</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>            <span class="c1"># Commit current database changes</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>            <span class="c1"># Translate lists of dictionaries to</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>            <span class="c1"># lists of strings</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>            <span class="n">flatten_dict_values</span><span class="p">(</span><span class="n">usernames</span><span class="p">)</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>            <span class="n">flatten_dict_values</span><span class="p">(</span><span class="n">passwords</span><span class="p">)</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>            <span class="c1"># Associate the newly inserted values</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>            <span class="k">if</span> <span class="n">associate_spray_values</span><span class="p">:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                <span class="c1"># Set spray values for new usernames</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">associate_spray_values</span><span class="p">(</span><span class="n">username_values</span><span class="o">=</span><span class="n">usernames</span><span class="p">)</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>                <span class="c1"># Set spray values for these passwords to all usernames</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">associate_spray_values</span><span class="p">(</span><span class="n">password_values</span><span class="o">=</span><span class="n">passwords</span><span class="p">)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>            <span class="c1"># Non-sprayable passwords</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">,</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>                <span class="n">values</span> <span class="o">=</span> <span class="n">passwords</span><span class="p">)</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>            <span class="c1"># Free up memory</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>            <span class="n">usernames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">credentials</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>            <span class="k">del</span><span class="p">(</span><span class="n">passwords</span><span class="p">)</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>            <span class="c1"># Commit database changes</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>            <span class="c1"># ===============================</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>            <span class="c1"># CREATE CREDENTIAL RECORD VALUES</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>            <span class="c1"># ===============================</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>            <span class="k">for</span> <span class="n">username</span> <span class="ow">in</span> <span class="n">usernames</span><span class="p">:</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>                <span class="n">passwords</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="n">username</span><span class="p">]</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>                <span class="k">del</span><span class="p">(</span><span class="n">credentials</span><span class="p">[</span><span class="n">username</span><span class="p">])</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>                <span class="c1"># ===============================</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>                <span class="c1"># CREATE CREDENTIAL RECORD VALUES</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>                <span class="c1"># ===============================</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>                <span class="n">username</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span> \
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>                    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">username</span><span class="p">)</span> \
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>                    <span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>                <span class="k">for</span> <span class="n">password</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span> \
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>                        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">passwords</span><span class="p">)):</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>                    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>                        <span class="n">username_id</span> <span class="o">=</span> <span class="n">username</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>                        <span class="n">password_id</span> <span class="o">=</span> <span class="n">password</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>                        <span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>            <span class="c1"># =============================</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>            <span class="c1"># UPSERT THE CREDENTIAL RECORDS</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>            <span class="c1"># =============================</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">,</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>                <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>                <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;username_id&#39;</span><span class="p">,</span> <span class="s1">&#39;password_id&#39;</span><span class="p">])</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>            <span class="k">if</span> <span class="n">associate_spray_values</span><span class="p">:</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>                <span class="c1"># Associate all sprayable passwords back to the new</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>                <span class="c1"># username values</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">associate_spray_values</span><span class="p">(</span><span class="n">username_values</span><span class="o">=</span><span class="n">usernames</span><span class="p">)</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>    <span class="n">chunk_container</span><span class="p">(</span><span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>        <span class="n">callback</span> <span class="o">=</span> <span class="n">_upsert_values</span><span class="p">,</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>        <span class="n">is_file</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">is_dictreader</span> <span class="ow">and</span> <span class="n">is_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.insert_password_records" class="doc doc-heading">
<code class="highlight language-python"><span class="n">insert_password_records</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Insert individual password records. Additional processing must
occur on individual passwords in order to make the associations
with username values.</p>
<p>Warning: This method assumes that the container has spray records,
resulting in each password being associated with each username in
the form of a potential credential.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="k">def</span> <span class="nf">insert_password_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>    <span class="sd">&#39;&#39;&#39;Insert individual password records. Additional processing must</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">    occur on individual passwords in order to make the associations</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">    with username values.</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">    Warning: This method assumes that the container has spray records,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">    resulting in each password being associated with each username in</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">    the form of a potential credential.</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>    <span class="k">def</span> <span class="nf">_upsert_values</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>        <span class="sd">&#39;&#39;&#39;Upsert password values.</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        Function ensures that password values inserted are treated</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">        as spray values. Should a known password be supplied in</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        chunk and that password&#39;s &quot;sprayable&quot; attribute be set to</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">        False, it will be updated to True.</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">,</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">],</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>            <span class="n">do_update_where</span> <span class="o">=</span> <span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">sprayable</span> <span class="o">==</span> <span class="kc">False</span><span class="p">),</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>            <span class="n">update_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sprayable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="k">if</span> <span class="n">associate_spray_values</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">associate_spray_values</span><span class="p">(</span><span class="n">password_values</span><span class="o">=</span><span class="n">chunk</span><span class="p">)</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="n">chunk_container</span><span class="p">(</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="n">callback</span> <span class="o">=</span> <span class="n">_upsert_values</span><span class="p">)</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="c1"># This method commits :)</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">sync_lookup_tables</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.insert_username_records" class="doc doc-heading">
<code class="highlight language-python"><span class="n">insert_username_records</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Insert each username value in the container into the target
database. Duplicates will not be inserted.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="k">def</span> <span class="nf">insert_username_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="sd">&#39;&#39;&#39;Insert each username value in the container into the target</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    database. Duplicates will not be inserted.</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="k">def</span> <span class="nf">_upsert_values</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">,</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">])</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="k">if</span> <span class="n">associate_spray_values</span><span class="p">:</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">associate_spray_values</span><span class="p">(</span><span class="n">username_values</span><span class="o">=</span><span class="n">chunk</span><span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="n">chunk_container</span><span class="p">(</span><span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="p">,</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="n">callback</span> <span class="o">=</span> <span class="n">_upsert_values</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.manage_credentials" class="doc doc-heading">
<code class="highlight language-python"><span class="n">manage_credentials</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">is_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">credential_delimiter</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">as_credentials</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_csv_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Manage credential values in the database.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>container</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td><p>A list of string values to manage. The mutually
exclusive <code>is_file</code> and <code>is_csv_file</code> flags determine how
values within this container are managed.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>credential_delimiter</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The sequenct to split credential
records on.</p></td>
          <td>
                <code>&#39;:&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>as_credentials</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if values being imported should
be treated as strict credentials.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>insert</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if values should be inserted (<code>True</code>) or
deleted (<code>False</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>is_file</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>When <code>True</code>, treat each value in <code>container</code> as a
path to a newline delimited file for processing.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>is_csv_file</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>When <code>True</code>, treat each value in <code>container</code> as
a CSV file for processing.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>associate_spray_values</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Indicates if spray values should be
associated after execution.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>logger</code></td>
          <td>
                <code><span title="logging.Logger">Logger</span></code>
          </td>
          <td><p>Logger for events.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Exception</code>
          </td>
          <td><p>when <code>is_file</code> and <code>is_csv_file</code> are set.</p></td>
        </tr>
    </tbody>
  </table>

<details class="notes">
  <summary>Notes</summary>
  <ul>
<li><code>is_file</code> and <code>is_csv_file</code> are mutually exclusive.</li>
<li>When both <code>is_file</code> and <code>is_csv_file</code> are <code>False</code>, values
  in container are imported directly as credential values.</li>
</ul>
</details>
      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="k">def</span> <span class="nf">manage_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">is_file</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>        <span class="n">credential_delimiter</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">as_credentials</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="n">insert</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_csv_file</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>        <span class="n">associate_spray_values</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span><span class="n">Logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="sd">&#39;&#39;&#39;Manage credential values in the database.</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">      container: A list of string values to manage. The mutually</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">        exclusive `is_file` and `is_csv_file` flags determine how</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">        values within this container are managed.</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">      credential_delimiter: The sequenct to split credential</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">        records on.</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">      as_credentials: Determines if values being imported should</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">        be treated as strict credentials.</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">      insert: Determines if values should be inserted (`True`) or</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">        deleted (`False`).</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">      is_file: When `True`, treat each value in `container` as a</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">        path to a newline delimited file for processing.</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">      is_csv_file: When `True`, treat each value in `container` as</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">        a CSV file for processing.</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">      associate_spray_values: Indicates if spray values should be</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">        associated after execution.</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">      logger: Logger for events.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">      Exception: when `is_file` and `is_csv_file` are set.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">      - `is_file` and `is_csv_file` are mutually exclusive.</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">      - When both `is_file` and `is_csv_file` are `False`, values</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">        in container are imported directly as credential values.</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>    <span class="k">if</span> <span class="n">is_file</span> <span class="ow">and</span> <span class="n">is_csv_file</span><span class="p">:</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;is_file and is_csv_file are mutually &#39;</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>            <span class="s1">&#39;exclusive.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>    <span class="c1"># ================================</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>    <span class="c1"># DERIVE METHOD AND PREPARE KWARGS</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>    <span class="c1"># ================================</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>    <span class="n">method</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;insert&#39;</span> <span class="k">if</span> <span class="n">insert</span> <span class="k">else</span> <span class="s1">&#39;delete&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_credential_records&#39;</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>    <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>        <span class="n">as_credentials</span> <span class="o">=</span> <span class="n">as_credentials</span><span class="p">,</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="n">credential_delimiter</span> <span class="o">=</span> <span class="n">credential_delimiter</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>    <span class="p">)</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>    <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">):</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;associate_spray_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">associate_spray_values</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>    <span class="c1"># ===================================</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>    <span class="c1"># CALL THE METHOD BASED ON INPUT TYPE</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>    <span class="c1"># ===================================</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>    <span class="k">if</span> <span class="n">is_csv_file</span><span class="p">:</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="c1"># ===============================</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="c1"># TREAT EACH RECORD AS A CSV FILE</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="c1"># ===============================</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                <span class="n">method</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">reader</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>    <span class="k">elif</span> <span class="n">is_file</span><span class="p">:</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>        <span class="c1"># ===========================</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>        <span class="c1"># TREAT EACH RECORD AS A FILE</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>        <span class="c1"># ===========================</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>                <span class="n">method</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="n">method</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>    <span class="c1"># This method commits :)</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">sync_lookup_tables</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.manage_priorities" class="doc doc-heading">
<code class="highlight language-python"><span class="n">manage_priorities</span><span class="p">(</span><span class="n">usernames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">passwords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prioritize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Prioritize or deprioritize database values.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>usernames</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>A list of string username values.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>passwords</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>A list of string password values.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>prioritize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Boolean determining if the values should be
prioritized or deprioritized.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="k">def</span> <span class="nf">manage_priorities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usernames</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>        <span class="n">passwords</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prioritize</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>        <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>    <span class="sd">&#39;&#39;&#39;Prioritize or deprioritize database values.</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">      usernames: A list of string username values.</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">      passwords: A list of string password values.</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">      prioritize: Boolean determining if the values should be</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">        prioritized or deprioritized.</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">usernames</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">passwords</span><span class="p">:</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;usernames or passwords required&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>    <span class="n">usernames</span> <span class="o">=</span> <span class="n">usernames</span> <span class="k">if</span> <span class="n">usernames</span> <span class="o">!=</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>    <span class="n">passwords</span> <span class="o">=</span> <span class="n">passwords</span> <span class="k">if</span> <span class="n">passwords</span> <span class="o">!=</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>    <span class="k">if</span> <span class="n">usernames</span><span class="p">:</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>        <span class="c1"># Manage username priorities</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>            <span class="n">update</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">)</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>                <span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>                    <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">usernames</span><span class="p">))</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>                <span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">priority</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>    <span class="k">if</span> <span class="n">passwords</span><span class="p">:</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>        <span class="c1"># Manage password priorities</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>            <span class="n">update</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>                <span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>                    <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="n">passwords</span><span class="p">))</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>                <span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">priority</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>    <span class="c1"># This method commits :)</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">sync_lookup_tables</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.manage_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">manage_values</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="n">is_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">associate_spray_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Manage username and password database records in a database.
It serves the same purpose as other <code>insert_</code> methods while
also handling containers of various file types.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[username, password]</code>
          </td>
          <td><p>Name of the model to target, i.e. username or
password.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>container</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td><p>A list of string values.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>insert</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if values should be inserted (<code>True</code>) or
deleted (<code>False</code>). The <code>is_flag</code> argument indicates if the
values within <code>container</code> should be treated as file paths.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>is_file</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Indicates if container values point to string file
paths. When <code>True</code>, each file will be accessed and
imported to the database.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>associate_spray_values</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if association records
should be created for the newly imported values. This
can often be delayed until the final passwords have been
imported.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>logger</code></td>
          <td>
                <code><span title="logging.Logger">Logger</span></code>
          </td>
          <td><p>Used to log events.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes">
  <summary>Notes</summary>
  <ul>
<li>This method is used to import spray values into the
  database.</li>
<li>Use <code>DBMixin.manage_credentials</code> to import credential
  values in the database.</li>
<li>Yes, <code>manage_credentials</code> can be used to treat credential
    records as spray values, too.</li>
</ul>
</details>
      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="k">def</span> <span class="nf">manage_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">,</span><span class="s1">&#39;password&#39;</span><span class="p">],</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="n">container</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="n">is_file</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">insert</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="n">associate_spray_values</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">logger</span><span class="p">:</span><span class="n">Logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="sd">&#39;&#39;&#39;Manage username and password database records in a database.</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    It serves the same purpose as other `insert_` methods while</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    also handling containers of various file types.</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">      model: Name of the model to target, i.e. username or</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">        password.</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">      container: A list of string values.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">      insert: Determines if values should be inserted (`True`) or</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        deleted (`False`). The `is_flag` argument indicates if the</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        values within `container` should be treated as file paths.</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">      is_file: Indicates if container values point to string file</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        paths. When `True`, each file will be accessed and</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        imported to the database.</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">      associate_spray_values: Determines if association records</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        should be created for the newly imported values. This</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        can often be delayed until the final passwords have been</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">        imported.</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">      logger: Used to log events.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">      - This method is used to import spray values into the</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        database.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">      - Use `DBMixin.manage_credentials` to import credential</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        values in the database.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        - Yes, `manage_credentials` can be used to treat credential</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">          records as spray values, too.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="c1"># ================================</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="c1"># DERIVE METHOD AND PREPARE KWARGS</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="c1"># ================================</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="c1"># Derive the target method to call based on action</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="n">method</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;insert&#39;</span> <span class="k">if</span> <span class="n">insert</span> <span class="k">else</span> <span class="s1">&#39;delete&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> \
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="p">(</span><span class="s1">&#39;username&#39;</span> <span class="k">if</span> <span class="n">model</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="p">,</span><span class="s1">&#39;username&#39;</span><span class="p">,)</span> <span class="k">else</span> <span class="s1">&#39;password&#39;</span><span class="p">)</span> <span class="o">+</span> \
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="s1">&#39;_records&#39;</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="c1"># Prepare kwargs</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>            <span class="n">associate_spray_values</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                <span class="n">method</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                <span class="ow">and</span> <span class="n">associate_spray_values</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="p">)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="c1"># ===================================</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="c1"># CALL THE METHOD BASED ON INPUT TYPE</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="c1"># ===================================</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="k">if</span> <span class="n">is_file</span><span class="p">:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                <span class="n">method</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="n">method</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>    <span class="c1"># This method commits :)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">sync_lookup_tables</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.DBMixin.sync_lookup_tables" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sync_lookup_tables</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Update the sql.StrictCredential and sql.PriorityCredential tables
with reference to the proper credential values.</p>
<p>sql.StrictCredential and sql.PriorityCredential are lookup tables
intended to be more efficiently refrenced than sql.Credental, which
contains all possible credential records. This means quicker query
response.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>logger</code></td>
          <td>
                <code><span title="logging.Logger">Logger</span></code>
          </td>
          <td><p>Logger instance to support event logging.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="k">def</span> <span class="nf">sync_lookup_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span><span class="n">Logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>    <span class="sd">&#39;&#39;&#39;Update the sql.StrictCredential and sql.PriorityCredential tables</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">    with reference to the proper credential values.</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">    sql.StrictCredential and sql.PriorityCredential are lookup tables</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">    intended to be more efficiently refrenced than sql.Credental, which</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">    contains all possible credential records. This means quicker query</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">    response.</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">        logger: Logger instance to support event logging.</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>    <span class="k">def</span> <span class="nf">_upsert_strict_creds</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">StrictCredential</span><span class="p">,</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>            <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;credential_id&#39;</span><span class="p">],</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>                <span class="nb">dict</span><span class="p">(</span><span class="n">credential_id</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">chunk</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>            <span class="p">])</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>    <span class="k">def</span> <span class="nf">_upsert_priority_creds</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">do_upsert</span><span class="p">(</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">PriorityCredential</span><span class="p">,</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>            <span class="n">index_elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;credential_id&#39;</span><span class="p">],</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>                <span class="nb">dict</span><span class="p">(</span><span class="n">credential_id</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">chunk</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>            <span class="p">])</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>    <span class="c1"># ==============================</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>    <span class="c1"># TODO: MAKE THIS MORE EFFICIENT</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>    <span class="c1"># ==============================</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>    <span class="c1"># Clear the lookup tables to start fresh</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>    <span class="c1">#  - We do this because some passwords may have been altered</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>    <span class="c1">#    since the last run</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">StrictCredential</span><span class="p">,</span> <span class="n">sql</span><span class="o">.</span><span class="n">PriorityCredential</span><span class="p">,):</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">delete</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>    <span class="c1"># ==================</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>    <span class="c1"># STRICT CREDENTIALS</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>    <span class="c1"># ==================</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="s1">&#39;Linking strict credentials&#39;</span><span class="p">)</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>    <span class="n">strict_query</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>            <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="p">)</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>            <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">strict</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>    <span class="p">)</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>    <span class="n">chunk_container</span><span class="p">(</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>        <span class="n">container</span> <span class="o">=</span> <span class="n">strict_query</span><span class="p">,</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>        <span class="n">callback</span> <span class="o">=</span> <span class="n">_upsert_strict_creds</span><span class="p">)</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>    <span class="c1"># ====================</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>    <span class="c1"># PRIORITY CREDENTIALS</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>    <span class="c1"># ====================</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="s1">&#39;Linking priority credentials&#39;</span><span class="p">)</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>    <span class="n">priority_query</span> <span class="o">=</span> <span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>        <span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>            <span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">password_id</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>                <span class="n">select</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>                    <span class="n">sql</span><span class="o">.</span><span class="n">Password</span><span class="o">.</span><span class="n">priority</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>            <span class="p">)</span> <span class="o">|</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>            <span class="n">sql</span><span class="o">.</span><span class="n">Credential</span><span class="o">.</span><span class="n">username_id</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>                <span class="n">select</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>                    <span class="n">sql</span><span class="o">.</span><span class="n">Username</span><span class="o">.</span><span class="n">priority</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>            <span class="p">)</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>        <span class="p">))</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="n">chunk_container</span><span class="p">(</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>        <span class="n">container</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">priority_query</span><span class="p">),</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>        <span class="n">callback</span> <span class="o">=</span> <span class="n">_upsert_priority_creds</span><span class="p">)</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="bruteloops.db_manager.Manager" class="doc doc-heading">
        <code>Manager</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="bruteloops.db_manager.DBMixin" href="#bruteloops.db_manager.DBMixin">DBMixin</a></code></p>

  
      <p>Default class used to interact with SQLite databases.</p>


        <details class="quote">
          <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><span class="k">class</span> <span class="nc">Manager</span><span class="p">(</span><span class="n">DBMixin</span><span class="p">):</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>    <span class="sd">&#39;&#39;&#39;Default class used to interact with SQLite databases.</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_file</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>        <span class="sd">&#39;&#39;&#39;Initialize a Manager object.</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">          db_file: Path to the database file to manage.</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">session_maker</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">db_file</span><span class="p">)</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>        <span class="s1">&#39;Object that makes sessions for the database.&#39;</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session_maker</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>        <span class="s1">&#39;Primary session used to interact with the database.&#39;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="bruteloops.db_manager.Manager.main_db_sess" class="doc doc-heading">
<code class="highlight language-python"><span class="n">main_db_sess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session_maker</span><span class="o">.</span><span class="n">new</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Primary session used to interact with the database.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="bruteloops.db_manager.Manager.session_maker" class="doc doc-heading">
<code class="highlight language-python"><span class="n">session_maker</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">db_file</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Object that makes sessions for the database.</p>
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.Manager.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">db_file</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a Manager object.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>db_file</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Path to the database file to manage.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_file</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>    <span class="sd">&#39;&#39;&#39;Initialize a Manager object.</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">      db_file: Path to the database file to manage.</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">session_maker</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">db_file</span><span class="p">)</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>    <span class="s1">&#39;Object that makes sessions for the database.&#39;</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">main_db_sess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session_maker</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>    <span class="s1">&#39;Primary session used to interact with the database.&#39;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="bruteloops.db_manager.Session" class="doc doc-heading">
        <code>Session</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Session objects are used to create and manage database
sessions.</p>


        <details class="quote">
          <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="k">class</span> <span class="nc">Session</span><span class="p">:</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>    <span class="sd">&#39;&#39;&#39;Session objects are used to create and manage database</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">    sessions.</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_file</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">echo</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>        <span class="sd">&#39;&#39;&#39;Initialize a session object.</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">          db_file: Path to the database file to manage.</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="sd">          echo: Passed to `sqlalchemy.create_engine`.</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>        <span class="c1"># =====================</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>        <span class="c1"># SQLITE INITIALIZATION</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>        <span class="c1"># =====================</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>        <span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;sqlite:///&#39;</span><span class="o">+</span><span class="n">db_file</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="n">echo</span><span class="p">)</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>        <span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="s1">&#39;connect&#39;</span><span class="p">,</span> <span class="n">_fk_pragma_on_connect</span><span class="p">)</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>        <span class="n">Session</span> <span class="o">=</span> <span class="n">sessionmaker</span><span class="p">()</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>        <span class="n">Session</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>        <span class="c1"># Create the database if required</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">db_file</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>            <span class="n">sql</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">Session</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>    <span class="k">def</span> <span class="nf">new</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>        <span class="sd">&#39;&#39;&#39;Create and return a new session.</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.Session.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">db_file</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a session object.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>db_file</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Path to the database file to manage.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>echo</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Passed to <code>sqlalchemy.create_engine</code>.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_file</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">echo</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>    <span class="sd">&#39;&#39;&#39;Initialize a session object.</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">      db_file: Path to the database file to manage.</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="sd">      echo: Passed to `sqlalchemy.create_engine`.</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>    <span class="c1"># =====================</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>    <span class="c1"># SQLITE INITIALIZATION</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>    <span class="c1"># =====================</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>    <span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;sqlite:///&#39;</span><span class="o">+</span><span class="n">db_file</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="n">echo</span><span class="p">)</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>    <span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="s1">&#39;connect&#39;</span><span class="p">,</span> <span class="n">_fk_pragma_on_connect</span><span class="p">)</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>    <span class="n">Session</span> <span class="o">=</span> <span class="n">sessionmaker</span><span class="p">()</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>    <span class="n">Session</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>    <span class="c1"># Create the database if required</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">db_file</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>        <span class="n">sql</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">Session</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bruteloops.db_manager.Session.new" class="doc doc-heading">
<code class="highlight language-python"><span class="n">new</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Create and return a new session.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="k">def</span> <span class="nf">new</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>    <span class="sd">&#39;&#39;&#39;Create and return a new session.</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="bruteloops.db_manager.check_container" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_container</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Determine if the container argument is a file-like
object and update the <code>is_file</code> and <code>is_dictreader</code>
keyword aguments accordingly.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>f</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span>[<span title="typing.Union">Union</span>[<span title="io.TextIOWrapper">TextIOWrapper</span>, csv.<span title="csv.DictReader">DictReader</span>], <span title="typing.Any">Any</span>]</code>
          </td>
          <td><p>Callable to decorate.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="k">def</span> <span class="nf">check_container</span><span class="p">(</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="n">f</span><span class="p">:</span><span class="n">Callable</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">TextIOWrapper</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">],</span> <span class="n">Any</span><span class="p">]):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="sd">&#39;&#39;&#39;Determine if the container argument is a file-like</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    object and update the `is_file` and `is_dictreader`</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    keyword aguments accordingly.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">      f: Callable to decorate.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">s</span> <span class="o">=</span> <span class="n">signature</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">pkeys</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="n">kkeys</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="k">if</span> <span class="s1">&#39;is_file&#39;</span> <span class="ow">in</span> <span class="n">pkeys</span> <span class="ow">and</span> <span class="n">container</span> <span class="ow">and</span> \
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>                <span class="s1">&#39;is_file&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kkeys</span><span class="p">:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;is_file&#39;</span><span class="p">]</span> <span class="o">=</span> \
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>                    <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="p">(</span><span class="n">TextIOWrapper</span><span class="p">,</span><span class="n">StringIO</span><span class="p">,))</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="k">if</span> <span class="s1">&#39;is_dictreader&#39;</span> <span class="ow">in</span> <span class="n">pkeys</span> <span class="ow">and</span> <span class="n">container</span> <span class="ow">and</span> \
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>                <span class="s1">&#39;is_dictreader&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kkeys</span><span class="p">:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;is_dictreader&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="bruteloops.db_manager.chunk_container" class="doc doc-heading">
<code class="highlight language-python"><span class="n">chunk_container</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">is_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">cargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ckwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Break a container of items down into chunks and pass them
to a callback for further processing. Particularly useful when
inserting/upserting records into a database.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>container</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>An iterable containing values to act upon.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>callback</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td><p>A callback that will receive the chunked values
from container.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>is_file</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Boolean value indicating if the records are
originating from a file. If so, newlines are stripped.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The maximum number of records to pass back to
<code>callback</code>.</p></td>
          <td>
                <code>10000</code>
          </td>
        </tr>
        <tr>
          <td><code>cargs</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td><p>Positional arguments passed to <code>callback</code>.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>ckwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Keyword arguments passed to `callback.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="nd">@check_container</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="k">def</span> <span class="nf">chunk_container</span><span class="p">(</span><span class="n">container</span><span class="p">:</span><span class="n">Any</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span><span class="n">Callable</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">is_file</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">cargs</span><span class="p">:</span><span class="nb">tuple</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="n">ckwargs</span><span class="p">:</span><span class="nb">dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="sd">&#39;&#39;&#39;Break a container of items down into chunks and pass them</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    to a callback for further processing. Particularly useful when</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    inserting/upserting records into a database.</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">      container: An iterable containing values to act upon.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">      callback: A callback that will receive the chunked values</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        from container.</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">      is_file: Boolean value indicating if the records are</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        originating from a file. If so, newlines are stripped.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">      threshold: The maximum number of records to pass back to</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        `callback`.</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">      cargs: Positional arguments passed to `callback`.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">      ckwargs: Keyword arguments passed to `callback.</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="n">cargs</span> <span class="o">=</span> <span class="n">cargs</span> <span class="k">if</span> <span class="n">cargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">tuple</span><span class="p">()</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="n">ckwargs</span> <span class="o">=</span> <span class="n">ckwargs</span> <span class="k">if</span> <span class="n">ckwargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">()</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="n">chunk</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="k">if</span> <span class="n">is_file</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="c1"># Strip newlines from file strings</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="n">v</span> <span class="o">=</span> <span class="n">strip_newline</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="c1"># Append the item to the chunk</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">chunk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="o">==</span> <span class="n">threshold</span><span class="p">:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="c1"># Call the callback for the chunk</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>            <span class="n">callback</span><span class="p">(</span><span class="o">*</span><span class="n">cargs</span><span class="p">,</span> <span class="n">chunk</span><span class="o">=</span><span class="n">chunk</span><span class="p">,</span> <span class="o">**</span><span class="n">ckwargs</span><span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>            <span class="n">chunk</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="k">if</span> <span class="n">chunk</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="c1"># Process any remaining chunks</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="n">callback</span><span class="p">(</span><span class="o">*</span><span class="n">cargs</span><span class="p">,</span> <span class="n">chunk</span><span class="o">=</span><span class="n">chunk</span><span class="p">,</span> <span class="o">**</span><span class="n">ckwargs</span><span class="p">)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="k">if</span> <span class="n">is_file</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">container</span><span class="p">,</span><span class="s1">&#39;seek&#39;</span><span class="p">):</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="c1"># Seek any containers back to 0</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">container</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="bruteloops.db_manager.csv_split" class="doc doc-heading">
<code class="highlight language-python"><span class="n">csv_split</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Split a string on the first instance of a delimiter value.
A tuple in the form of <code>(s_head,s_tail)</code> is returned, otherwise
a tuple of <code>(None,None)</code> if the delimiter is not observed.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="k">def</span> <span class="nf">csv_split</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">):</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="sd">&#39;&#39;&#39;Split a string on the first instance of a delimiter value.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    A tuple in the form of `(s_head,s_tail)` is returned, otherwise</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    a tuple of `(None,None)` if the delimiter is not observed.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="n">ind</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">delimiter</span><span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="n">ind</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">:],)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="bruteloops.db_manager.flatten_dict_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">flatten_dict_values</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Modify a list of dictionaries with a "value" element and
"flatten" it such that it becomes a list of individual string
values.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lst</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[str, str]]</code>
          </td>
          <td><p>List of dictionary values.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

<details class="warnings">
  <summary>Warnings</summary>
  <ul>
<li><code>lst</code> is modified inline.</li>
</ul>
</details>
      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="k">def</span> <span class="nf">flatten_dict_values</span><span class="p">(</span><span class="n">lst</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]):</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="sd">&#39;&#39;&#39;Modify a list of dictionaries with a &quot;value&quot; element and</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    &quot;flatten&quot; it such that it becomes a list of individual string</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    values.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">      lst: List of dictionary values.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    Warnings:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">      - `lst` is modified inline.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)):</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="bruteloops.db_manager.is_iterable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Check if an object has the <code>__iter__</code> and <code>__next__</code> attributes,
suggesting it is an iterable object.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="k">def</span> <span class="nf">is_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="sd">&#39;&#39;&#39;Check if an object has the `__iter__` and `__next__` attributes,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    suggesting it is an iterable object.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="fm">__dir__</span><span class="p">()</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">if</span> <span class="s1">&#39;__iter__&#39;</span> <span class="ow">in</span> <span class="n">d</span> <span class="ow">and</span> <span class="s1">&#39;__next__&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="bruteloops.db_manager.scan_dictreader" class="doc doc-heading">
<code class="highlight language-python"><span class="n">scan_dictreader</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">as_credentials</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Scan the container and find the username and password keys.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>container</code></td>
          <td>
                <code>csv.<span title="csv.DictReader">DictReader</span></code>
          </td>
          <td><p>Dictreader to scan username/password key from.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>as_credentials</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if a ValueError exception should be
raised when the keys are not enumerated.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[str, str]</code>
          </td>
          <td><p>Tuple containing the enumerated keys.</p></td>
        </tr>
    </tbody>
  </table>

<details class="notes">
  <summary>Notes</summary>
  <ul>
<li>This is a terribly stupid function.</li>
<li>Suspect I'd initially thought of searching all headers and
  hitting on any that contained the "username" and "password"
  strings.</li>
</ul>
</details>
<details class="todo">
  <summary>Todo</summary>
  <ul>
<li>Remove this function and all references in future versions.</li>
</ul>
</details>
      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="k">def</span> <span class="nf">scan_dictreader</span><span class="p">(</span><span class="n">container</span><span class="p">:</span><span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">as_credentials</span><span class="p">:</span><span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="sd">&#39;&#39;&#39;Scan the container and find the username and password keys.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">      container: Dictreader to scan username/password key from.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">      as_credentials: Determines if a ValueError exception should be</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        raised when the keys are not enumerated.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">      Tuple containing the enumerated keys.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">      - This is a terribly stupid function.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">      - Suspect I&#39;d initially thought of searching all headers and</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        hitting on any that contained the &quot;username&quot; and &quot;password&quot;</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        strings.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    Todo:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">      - Remove this function and all references in future versions.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="c1"># TODO: Update this such that the user can specify the</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="c1"># columns for the username/password values.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="c1"># Iterate over each field name and find the username</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="c1"># and password field</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">username_key</span><span class="p">,</span> <span class="n">password_key</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">container</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="k">if</span> <span class="n">username_key</span> <span class="ow">and</span> <span class="n">password_key</span><span class="p">:</span> <span class="k">break</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">RE_USERNAME</span><span class="p">,</span><span class="n">k</span><span class="p">):</span> <span class="n">username_key</span> <span class="o">=</span> <span class="n">k</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">RE_PASSWORD</span><span class="p">,</span><span class="n">k</span><span class="p">):</span> <span class="n">password_key</span> <span class="o">=</span> <span class="n">k</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="c1"># Ensure that there&#39;s a username and password key</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="c1"># in the header field</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">if</span> <span class="n">as_credentials</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">username_key</span> <span class="ow">or</span> \
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="ow">not</span> <span class="n">password_key</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="s1">&#39;CSV file must have &quot;username&quot; and &quot;password&quot; &#39;</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="s1">&#39;word field in the first line of the CSV file &#39;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="s1">&#39;in order to map the inputs properly. Skipping&#39;</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="s1">&#39; CSV file. Current fields: &#39;</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">container</span><span class="o">.</span><span class="n">fieldnames</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="k">elif</span> <span class="ow">not</span> <span class="n">username_key</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">password_key</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="s1">&#39;CSV file must have at least a &quot;username&quot; or &#39;</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="s1">&#39;&quot;password&quot; field in the first line of the&#39;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="s1">&#39; CSV file in order to map the inputs &#39;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="s1">&#39;properly. Skipping CSV file.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">return</span> <span class="n">username_key</span><span class="p">,</span> <span class="n">password_key</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="bruteloops.db_manager.split_credential_container" class="doc doc-heading">
<code class="highlight language-python"><span class="n">split_credential_container</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">username_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credential_delimiter</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">as_credentials</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">non_cred_format</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Split a container of credential values into three containers and
return them.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>container</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>A container of credential values to handle.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>username_key</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>When working on a csv.DictReader object, the header
for the username column.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>password_key</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>When working on a csv.DictReader object, the header
for the password column.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>as_credentials</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the values should be strict credentials.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>credential_delimiter</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Character/sequence used to delimit username and
password values.</p></td>
          <td>
                <code>&#39;:&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>non_cred_format</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[list, dict]</code>
          </td>
          <td><p>Dictates the output format of non-credential values,
i.e. usernames or passwords. Expects either <code>dict</code> or <code>list</code>. When
<code>dict</code> is supplied, password values will also include the proper
"sprayable" attribute value in accordance with the value supplied
for <code>as_credentials</code>. In both cases, <code>dict</code> format produces a
structure like <code>{"value":"username or password"}</code>, making <code>dict</code>
the most suitable input when preparing to insert records. When
<code>list</code> is supplied, a list of string values will be returned.</p></td>
          <td>
                <code>dict</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[dict, list, list]</code>
          </td>
          <td><p>A tuple:</p>
<ul>
<li>Element 1: dictionary of credential values, organized by username.</li>
<li>Element 2: A list of username or dictionary values.</li>
<li>Element 3: A list of password or dictionary values.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="k">def</span> <span class="nf">split_credential_container</span><span class="p">(</span><span class="n">container</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">username_key</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">password_key</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credential_delimiter</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">as_credentials</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="n">non_cred_format</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span><span class="nb">dict</span><span class="p">]</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="sd">&#39;&#39;&#39;Split a container of credential values into three containers and</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    return them.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">      container: A container of credential values to handle.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">      username_key: When working on a csv.DictReader object, the header</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        for the username column.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">      password_key: When working on a csv.DictReader object, the header</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        for the password column.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">      as_credentials: Determines if the values should be strict credentials.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">      credential_delimiter: Character/sequence used to delimit username and</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        password values.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">      non_cred_format: Dictates the output format of non-credential values,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        i.e. usernames or passwords. Expects either `dict` or `list`. When</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        `dict` is supplied, password values will also include the proper</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        &quot;sprayable&quot; attribute value in accordance with the value supplied</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        for `as_credentials`. In both cases, `dict` format produces a</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        structure like `{&quot;value&quot;:&quot;username or password&quot;}`, making `dict`</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        the most suitable input when preparing to insert records. When</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        `list` is supplied, a list of string values will be returned.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">      A tuple:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        - Element 1: dictionary of credential values, organized by username.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        - Element 2: A list of username or dictionary values.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        - Element 3: A list of password or dictionary values.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">is_dictreader</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">if</span> <span class="n">is_dictreader</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">username_key</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">password_key</span><span class="p">):</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="s1">&#39;username_key and username_key required when operating &#39;</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="s1">&#39;on csv.DictReader objects.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="n">credentials</span><span class="p">,</span> <span class="n">usernames</span><span class="p">,</span> <span class="n">passwords</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">[],</span> <span class="p">[]</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">while</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="k">if</span> <span class="n">is_dictreader</span> <span class="ow">or</span> <span class="p">(</span><span class="n">username_key</span> <span class="ow">and</span> <span class="n">password_key</span><span class="p">):</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="c1"># Parsed from CSV library because we have a reader</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="n">username</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">username_key</span><span class="p">],</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                <span class="n">value</span><span class="p">[</span><span class="n">password_key</span><span class="p">],)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="c1"># Parsed as a non-standard CSV value</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="n">username</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="n">csv_split</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                    <span class="n">credential_delimiter</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="c1"># ================================</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="c1"># CAPTURE USERNAME/PASSWORD VALUES</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="c1"># ================================</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="k">if</span> <span class="n">username</span><span class="p">:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="c1"># Capture the username value</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="n">usernames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">username</span><span class="p">))</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="c1"># Capture the password value</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="n">passwords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">password</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="n">sprayable</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">as_credentials</span><span class="p">))</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="k">if</span> <span class="n">as_credentials</span> <span class="ow">and</span> <span class="n">username</span> <span class="ow">and</span> <span class="n">password</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="c1"># ============================</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="c1"># AGGREGATE CREDENTIAL RECORDS</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="c1"># ============================</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span> <span class="ow">in</span> <span class="n">credentials</span><span class="p">:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                <span class="c1"># Track new username</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                <span class="n">credentials</span><span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">password</span><span class="p">]</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="k">elif</span> <span class="n">username</span> <span class="ow">in</span> <span class="n">credentials</span> <span class="ow">and</span> <span class="ow">not</span> \
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>                    <span class="n">password</span> <span class="ow">in</span> <span class="n">credentials</span><span class="p">[</span><span class="n">username</span><span class="p">]:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                <span class="c1"># Insert new password for username</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>                <span class="n">credentials</span><span class="p">[</span><span class="n">username</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="k">return</span> <span class="n">credentials</span><span class="p">,</span> <span class="n">usernames</span><span class="p">,</span> <span class="n">passwords</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="bruteloops.db_manager.strip_newline" class="doc doc-heading">
<code class="highlight language-python"><span class="n">strip_newline</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Strips the final character from a string via list comprehension.
Useful when <code>str.strip()</code> might pull a legitimate whitespace
character from a password.</p>

      <details class="quote">
        <summary>Source code in <code>bruteloops/db_manager.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="k">def</span> <span class="nf">strip_newline</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="sd">&#39;&#39;&#39;Strips the final character from a string via list comprehension.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    Useful when ```str.strip()``` might pull a legitimate whitespace</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    character from a password.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>